#!/usr/bin/env php
<?php

use Naivechain\Query\AddPeerQuery;
use Naivechain\Block;
use Naivechain\BlockChain;
use Naivechain\Query\GetBlocksQuery;
use Naivechain\Query\GetPeersQuery;
use Naivechain\PeersRepository;
use Naivechain\QueryResolver;
use Naivechain\Server;

require_once __DIR__ . '/../vendor/autoload.php';

$peersRepository = new PeersRepository();

$blockChain = new BlockChain([
    new Block(0)
]);

$server = new Server(
    '127.0.0.1',
    1234,
    new QueryResolver([
        new GetPeersQuery($peersRepository),
        new AddPeerQuery($peersRepository),
        new GetBlocksQuery($blockChain)
    ])
);

$server->run();
